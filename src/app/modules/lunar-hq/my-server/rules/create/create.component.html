<app-why-header-side-nav
  [title]="'my servers'"
  [activeTab]="'MY SERVERS'"
  [activeSubMenuTab]="activeSubMenu"
  (profileClick)="navigateToMyServer()">
<div class="flex flex-nowrap">
    <div id="stepper2" class="bs-stepper">
    <div class="create-rule-header">
        <div class="back-button">
            <div class="pd-left-24 pd-top-21 pd-bottom-21">
                <app-why-cta-three [btnClass]="cssClass.cta3Primary" [btnLabel]="'Back'"
                [leftIconType]="'chevron-back'" [iconClass]="cssClass.cta3PrimaryIcon" (click)="navigateBack()">
                </app-why-cta-three>
            </div>
        </div>
        <div class="bs-stepper-header justify-content-center">
            <div class="step" id="step-0" data-target="#rule-details">
              <button class="step-trigger">
                <span class="bs-stepper-label app-why-lbl f10 text-center light-50 ft-lato">{{stepTitles[0]}}</span>
              </button>
            </div>
            <div class="step" id="step-1" data-target="#create-rule">
              <button class="step-trigger">
                <span class="bs-stepper-label app-why-lbl f10 text-center light-50 ft-lato">{{stepTitles[1]}}</span>
              </button>
            </div>
            <div class="step" id="step-2" data-target="#rule-preview">
              <button class="step-trigger">
                <span class="bs-stepper-label app-why-lbl f10 text-center light-50 ft-lato">{{stepTitles[2]}}</span>
              </button>
            </div>
          </div>
    </div>
                
        <div class="bs-stepper-content rule-container d-flex flex-column mr-top-56">
            <form [formGroup]="createRuleForm">
                <div id="rule-details" class="content">
                    <div class="rule-details-container d-flex flex-column pd-top-24 pd-lr-40">
                        <div class="rule-details-header-title d-flex justify-content-between">
                        <div class="app-why-lbl f16 ft-bold light no-letter-spacing">{{stepTitle}}</div>
                        </div>
                        <div class="title-underline mr-top-8"></div>
                        <div class="rule-details-content">
                            <div class="mr-top-48 pd-lr-78 form-control-wrapper">
                                <div class="form-group">
                                    <input type="text" id="name" class="form-control app-why-floating-input"
                                        placeholder=" " formControlName="name">
                                    <label class="app-why-floating-lbl" for="name">Name</label>
                                </div>
                                <div class="form-group mr-top-40">
                                    <label class="d-flex app-why-lbl ft-lato f10 light-50" for="description">Description</label>
                                    <textarea name="description" class="app-why-lbl f16 ft-lato light mr-top-4 description_area no-letter-spacing pd-top-8 pd-bottom-8 pd-lr-16" formControlName="description" id="description" maxlength="2000" (keyup)="countCharacter()" placeholder="Describe the rule"></textarea>
                                    <div class="d-flex justify-content-end app-why-lbl f10 ft-lato light-50" id="description_count">
                                    <span id="current_count">0 &nbsp;</span>
                                    <span id="maximum_count"> / 500</span>
                                    </div>
                                </div>
                                <div class="d-flex mr-top-24 overflow-hidden">
                                    <div ngbDropdown container="body">
                                        <button type="button" class="link-dropdown app-why-lbl f12 ft-bold light-50"
                                                ngbDropdownToggle>{{selectedRole}}
                                        </button>
                                        <div ngbDropdownMenu aria-labelledby="dropdownBasic">
                                            <ng-container *ngFor="let role of roles">
                                                <button ngbDropdownItem class="pd-left-24 app-why-lbl f12 ft-bold no-letter-spacing"
                                                        (click)="selectRole(role)">{{role.name}}
                                                </button>
                                                <div class="dropdown-divider"></div>
                                            </ng-container>
                                        </div>
                                    </div>
                                    <input type="hidden" id="role" class="form-control app-why-floating-input"
                                        formControlName="role">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="create-rule" class="content">
                    <div  class="create-rule-container d-flex flex-column pd-top-24 pd-lr-40">
                        <div class="create-rule-header-title d-flex justify-content-between">
                        <div class="app-why-lbl f16 ft-bold light no-letter-spacing">{{stepTitle}}</div>
                        </div>
                        <div class="title-underline mr-top-8"></div>
                        <div class="create-rule-content">
                            <div class="rule-item mr-top-24" *ngFor="let ruleItem of ruleItems; let ruleItemIndex = index;">
                                <div class="rule-item-detail pd-lr-16">
                                    <div class="d-flex overflow-hidden rule-item-type pd-top-16">
                                        <div ngbDropdown container="body">
                                            <button type="button" class="link-dropdown app-why-lbl f12 ft-bold light-50"
                                                    ngbDropdownToggle>{{ruleItem.ruleTypeId != '' ? ruleItem.ruleType : 'SELECT RULE TYPE'}}
                                            </button>
                                            <div ngbDropdownMenu aria-labelledby="dropdownBasic">
                                                <ng-container *ngFor="let ruleType of ruleTypes">
                                                    <button ngbDropdownItem class="pd-left-24 app-why-lbl f12 ft-bold no-letter-spacing"
                                                            (click)="selectRuleType(ruleItem, ruleType)">{{ruleType.name}}
                                                    </button>
                                                    <div class="dropdown-divider"></div>
                                                </ng-container>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center mr-top-16 rule-item-rule">
                                        <div class="rule-item-is-text app-why-lbl f12 ft-bold light-50 letter-spacing-047">IS</div>
                                        <div class="d-flex overflow-hidden rule-item-select-rule mr-left-24">
                                            <div ngbDropdown container="body">
                                                <button type="button" class="link-dropdown app-why-lbl f12 ft-bold light-50"
                                                        ngbDropdownToggle>{{ruleItem.ruleId != '' ? ruleItem.rule : 'SELECT RULE'}}
                                                </button>
                                                <div ngbDropdownMenu aria-labelledby="dropdownBasic">
                                                    <ng-container *ngFor="let rule of rules">
                                                        <button ngbDropdownItem class="pd-left-24 app-why-lbl f12 ft-bold no-letter-spacing"
                                                                (click)="selectRule(ruleItem, rule)">{{rule.name}}
                                                        </button>
                                                        <div class="dropdown-divider"></div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="rule-item-sections d-flex flex-column">
                                    <div class="rule-item-section mr-top-8 pd-lr-16" *ngFor="let section of ruleItem.sections; let sectionIndex = index;">
                                        <div class="section-close-button d-flex justify-content-end align-items-end mr-top-8 add-cursor" (click)="removeSection(ruleItemIndex, sectionIndex)">
                                            <ion-icon name="close-outline" class="app-why-icon ic18 light-50"></ion-icon>
                                        </div>
                                        <div class="d-flex align-items-center mr-top-16 rule-item-rule">
                                            <div class="rule-item-is-text app-why-lbl f12 ft-bold success letter-spacing-047">AND</div>
                                            <div class="d-flex overflow-hidden rule-item-select-rule mr-left-24">
                                                <div ngbDropdown container="body">
                                                    <button type="button" class="link-dropdown app-why-lbl f12 ft-bold light-50"
                                                            ngbDropdownToggle>SELECT ROLE
                                                    </button>
                                                    <div ngbDropdownMenu aria-labelledby="dropdownBasic">
                                                        <ng-container *ngFor="let role of roles">
                                                            <button ngbDropdownItem class="pd-left-24 app-why-lbl f12 ft-bold no-letter-spacing"
                                                                    (click)="selectRole(role)">{{role.name}}
                                                            </button>
                                                            <div class="dropdown-divider"></div>
                                                        </ng-container>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="rule-item-add-section mr-top-24 add-cursor" (click)="addSection(ruleItemIndex)">
                                    <ion-icon name="add-circle-outline" class="app-why-icon ic12 light-50"></ion-icon>
                                    <label class="align-text-top app-why-lbl f12 ft-bold light-50 mr-left-8">ADD SECTION</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rule-preview" class="content text-center">
                    <button (click)="next()" class="btn btn-primary mt-5">Next</button>
                </div>
            </form>
          <div class="d-flex navigate-steps mr-top-24">
            <div class="col-3 add-cursor">
                <span *ngIf="stepperIndex == 1">
                    <ion-icon name="add-circle-outline" class="app-why-icon ic12 light-50"></ion-icon>
                    <label class="align-text-top app-why-lbl f12 ft-bold light-50 mr-left-8">ADD RULE</label>
                </span>
            </div>
            <div class="d-flex justify-content-end col-9"> 
                <app-why-lunar-hq-cta-two *ngIf="stepperIndex != 0"
                    [btnLabel]="'BACK'"
                    [btnTheme]="'bg--dark'"
                    [buttonSize]="'sm'"
                    (click)="previous()"
                    [btnLabelClass]="'app-why-lbl f12 ft-lato ft-bold'">
                </app-why-lunar-hq-cta-two>        
                <app-why-cta-one *ngIf="stepperIndex === 0"
                    (click)="next()"
                    [cssClass]="cssClass.cta1Sm + ' mr-left-24'"
                    [btnLabel]="'NEXT'">
                </app-why-cta-one>     
                <app-why-cta-one *ngIf="stepperIndex != 0"
                    (click)="preview()"
                    [cssClass]="cssClass.cta1Sm + ' mr-left-24'"
                    [btnLabel]="'PREVIEW'">
                </app-why-cta-one>
            </div>
          </div>
        </div>
</div>
</div>
<!--</app-why-side-nav>-->
</app-why-header-side-nav>
